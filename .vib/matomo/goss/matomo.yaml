# Copyright Broadcom, Inc. All Rights Reserved.
# SPDX-License-Identifier: APACHE-2.0

group:
  daemon:
    exists: true
user:
  daemon:
    exists: true
file:
  # HTTPs vhost should have been properly rendered
  /opt/bitmoa/apache/conf/vhosts/matomo-https-vhost.conf:
    exists: true
    filetype: file
    contents:
      - "SSLEngine on"
      - /DocumentRoot.*/opt/bitmoa/matomo/
  /opt/bitmoa/apache/conf/vhosts/htaccess/matomo-htaccess.conf:
    exists: false
  /opt/bitmoa/php/etc/php.ini:
    exists: true
    filetype: file
    contents:
      - "memory_limit = 256M"
      - "mysqli.allow_local_infile = 1"
      - "extension = maxminddb.so"
  /opt/bitmoa/matomo/piwik:
    exists: false
  /opt/bitmoa/matomo/How to install Matomo.html:
    exists: false
  /opt/bitmoa/matomo/licenses:
    exists: false
  /opt/bitmoa/matomo/.buildcomplete:
    exists: false
command:
  check-app-run:
    exec: php /opt/bitmoa/matomo/console config:get --section=database
    exit-status: 0
    stdout:
      - "Mysql"
