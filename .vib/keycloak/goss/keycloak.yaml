# Copyright Broadcom, Inc. All Rights Reserved.
# SPDX-License-Identifier: APACHE-2.0

group:
  keycloak:
    exists: true
user:
  keycloak:
    exists: true
file:
  /opt/bitmoa/keycloak:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/providers:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/providers/log:
    exists: true
    mode: "0775"     
    owner: keycloak     
    filetype: directory
  /opt/bitmoa/keycloak/providers/tmp:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/conf:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/.installation:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/data:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/lib:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /bitmoa/keycloak:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /docker-entrypoint-initdb.d:
    exists: true
    mode: "0775"
    owner: keycloak
    filetype: directory
  /opt/bitmoa/keycloak/modules/system/layers/keycloak/org/postgresql/jdbc/main/module.xml:
    exists: true
    contents:
      - "<module xmlns=\"urn:jboss:module:1.0\" name=\"org.postgresql.jdbc\">"
command:
  check-app-version:
    # kc.sh --version only works after server initialization. Checking the version.txt instead.
    exec: cat /opt/bitmoa/keycloak/version.txt
    exit-status: 0
    stdout:
    - "{{ .Env.APP_VERSION }}"
